numProcs     = 8         # number of processors - change logNumProcs too
logNumProcs  = 3
issue        = 4          # processor issue width

cpucore[0:$(numProcs)-1] = 'issueX'

#<shared.conf> (contents below)

##############################
# SYSTEM                     #
##############################

enableICache   = true
NoMigration    = true
tech           = 0.10
procsPerNode   = 2
pageSize       = 4096
fetchPolicy    = 'outorder'
issueWrongPath = true

##############################
# PROCESSORS' CONFIGURATION  #
##############################

[issueX]
frequency       = 5e9
areaFactor      = ($(issue)*$(issue)+0.1)/16  # Area compared to Alpha264 EV6
inorder         = false
fetchWidth      = $(issue)
instQueueSize   = 2*$(issue)
issueWidth      = $(issue)
retireWidth     = $(issue)+1
decodeDelay     = 6
renameDelay     = 3
wakeupDelay     = 6                 # -> 6+3+6+1+1=17 branch mispred. penalty
maxBranches     = 16*$(issue)
bb4Cycle        = 1
maxIRequests    = 4
interClusterLat = 2
intraClusterLat = 1
cluster[0]      = 'FXClusterIssueX'
cluster[1]      = 'FPClusterIssueX'
stForwardDelay  = 2 
maxLoads        = 10*$(issue)+16
maxStores       = 10*$(issue)+16
robSize         = 36*$(issue)+32
intRegs         = 32+16*$(issue)
fpRegs          = 32+12*$(issue)
bpred           = 'BPredIssueX'
dtlb            = 'FXDTLB'
itlb            = 'FXITLB'
dataSource      = "DMemory DL1"
instrSource     = "IMemory IL1"
OSType          = 'dummy'


# integer functional units

[FXClusterIssueX]
winSize    = 12*$(Issue)+32 # number of entries in window
recycleAt  = 'Execute'
iStoreLat  = 1
iStoreUnit = 'LDSTIssueX'
iLoadLat   = 1
iLoadUnit  = 'LDSTIssueX'
iALULat    = 1
iALUUnit   = 'ALUIssueX'
iBJLat     = 1
iBJUnit    = 'ALUIssueX'
iDivLat    = 12
iDivUnit   = 'ALUIssueX'
iMultLat   = 4
iMultUnit  = 'ALUIssueX'

[LDSTIssueX]
Num = $(issue)/3+1
Occ = 1

[ALUIssueX]
Num = $(issue)/3+1
Occ = 1

# floating point functional units

[FPClusterIssueX]
winSize    = 8*$(issue)
recycleAt  = 'Execute'
fpALULat   = 1
fpALUUnit  = 'FPIssueX'
fpMultLat  = 2
fpMultUnit = 'FPIssueX'
fpDivLat   = 10
fpDivUnit  = 'FPIssueX'

[FPIssueX]
Num = $(issue)/2+1
Occ = 1

# branch prediction mechanism

[BPredIssueX]
type          = "hybrid"
BTACDelay     = 0
l1size        = 1
l2size        = 16*1024
l2Bits        = 1
historySize   = 11
Metasize      = 16*1024
MetaBits      = 2
localSize     = 16*1024
localBits     = 2
btbSize       = 2048
btbBsize      = 1
btbAssoc      = 2
btbReplPolicy = 'LRU'
btbHistory    = 0
rasSize       = 32

# memory translation mechanism

[FXDTLB]
size       = 64*8
assoc      = 4
bsize      = 8
numPorts   = 2
replPolicy = 'LRU'

[FXITLB]
size       = 64*8
assoc      = 4
bsize      = 8
numPorts   = 2
replPolicy = 'LRU'

##############################
# MEMORY SUBSYSTEM           #
##############################

# instruction source
[IMemory]
deviceType    = 'icache'
size          = 32*1024
assoc         = 2
bsize         = 32
writePolicy   = 'WT'
replPolicy    = 'LRU'
numPorts      = 2
portOccp      = 1
hitDelay      = 2
missDelay     = 1                # this number is added to the hitDelay
MSHRsize      = 32
MSHRtype      = 'full'
lowerLevel    = "L1L2Bus L1L2"

# data source
[DMemory]
deviceType    = 'cache'
size          = 32*1024
assoc         = 4
bsize         = 32
writePolicy   = 'WT'
replPolicy    = 'LRU'
numPorts      = $(issue)/3+1
portOccp      = 1
hitDelay      = 2
missDelay     = 1                #this number is added to the hitDelay
MSHRsize      = 64
MSHRtype      = 'full'
lowerLevel    = "L1L2Bus L1L2"

# bus between L1s and L2
[L1L2Bus]
deviceType = 'bus'
numPorts   = 1
portOccp   = 8                   # assuming 32 bit bus
delay      = 1
lowerLevel = "ShCache SharedL2 sharedBy 2"

# shared L2
[ShCache]
deviceType    = 'dsmcache'
size          = 512*1024
assoc         = 8
bsize         = 32
writePolicy   = 'WB'
replPolicy    = 'LRU'
numPorts      = 2                # one for L1, one for snooping
portOccp      = 2
hitDelay      = 9
missDelay     = 5                # this number is added to the hitDelay
MSHRsize      = 64
MSHRtype      = 'full'
lowerLevel    = "L2L3Bus L2L3"
network[0]    = 'ControlNetwork'
network[1]    = 'DataNetwork'

[L2L3Bus]
deviceType    = 'bus'
numPorts      = 2
portOccp      = 2
delay         = 1
lowerLevel    = "L3 L3"

[ControlNetwork]
type          = 'uniring'
protocol      = control
SHCacheConn   = 4                # this field must have same name as object 
			         # connected to network + Conn
fixMessagePath = true            # packets from A to B always follow same path
congestionFree = false		 # do not model routers fixed time for packet
addFixDelay    = 0               # if congestionFree is true, fixed time
crossLat       = 1
localNum       = 2               # number of local connection points
localPort      = 1		 # number of ports per local connection point
localLat       = 1		 # local port latency
localOcc       = 1 		 # local port occupancy (0 is unlimited)

# mesh parameters
width          = 2               # size of a mesh dimension 2 --> 4 routers
linkBits       = 64              # link width in bits
wireLat        = 1               # wire latency

# ring parameters
numRouters     = 4
linkBits       = 8
wireLat        = 1

[DataNetwork]
type          = 'uniring'
protocol      = data
SHCacheConn   = 4                # this field must have same name as object 
			         # connected to it + Conn
fixMessagePath = true            # packets from A to B always follow same path
congestionFree = false		 # do not model routers fixed time for packet
addFixDelay    = 0               # if congestionFree is true, fixed time
crossLat       = 1
localNum       = 2               # number of local connection points
localPort      = 1		 # number of ports per local connection point
localLat       = 1		 # local port latency
localOcc       = 1 		 # local port occupancy (0 is unlimited)

# mesh parameters
width          = 2               # size of a mesh dimension 2 --> 4 routers
linkBits       = 64              # link width in bits
wireLat        = 1               # wire latency

# ring parameters
numRouters     = 4
linkBits       = 64
wireLat        = 1


[L3]
deviceType    = 'cache'
size          = 1024*1024
assoc         = 16
bsize         = 32
writePolicy   = 'WB'
replPolicy    = 'LRU'
numPorts      = 2                # one for L2, one for memory requests
portOccp      = 3
hitDelay      = 16
missDelay     = 8                # this number is added to the hitDelay
MSHRsize      = 128
MSHRtype      = 'full'
lowerLevel    = "MemoryBus L3MemBus"


[MemoryBus]
deviceType    = 'bus'
busCmd        = 3
busData       = 32
numPorts      = 4
portOccp      = 2
delay         = 3
lowerLevel    = "Memory Memory"

[Memory]
deviceType    = 'niceCache'
size          = 64
assoc         = 1
bsize         = 64
writePolicy   = 'WB'
replPolicy    = 'LRU'
numPorts      = 1
portOccp      = 1
readDelay     = 500 - 32         # 5.0GHz: 100ns is 500 cycles RTT - 32 busData
missDelay     = 160
hitDelay      = 160
MSHRsize      = 128
MSHRtype      = 'full'
lowerLevel    = 'voidDevice'

[voidDevice]
deviceType    = 'void'


##############################
# MEM ADDRESSES DISTRIBUTION #
##############################

[AdvMemMap]
MapType      = "blocked"
log2TileSize = 32 - $(logNumProcs) 
useNetwork   = false
